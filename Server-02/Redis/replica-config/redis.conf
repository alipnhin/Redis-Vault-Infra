# تنظیمات برای نود replica Redis در سرور 2
# این کانفیگ روی پورت 6379 گوش می‌دهد (در داکر مپ شده به 6380)

# تنظیمات اصلی
port 6379
bind 0.0.0.0
protected-mode no
daemonize no

# تنظیمات کلاستر
cluster-enabled yes
cluster-config-file /data/nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 192.168.57.67
# می‌توانید از نام دامنه به جای IP نیز استفاده کنید:
# cluster-announce-hostname redis-02.etadbir.com
cluster-announce-port 6380
cluster-announce-bus-port 16380

# تنظیمات امنیتی
requirepass YourStrongPassword
masterauth YourStrongPassword
# برای دسترسی از طریق si-redis.etadbir.com
bind 0.0.0.0
protected-mode no

# تنظیمات پرفورمنس
maxmemory 50gb
maxmemory-policy allkeys-lru
tcp-backlog 511
timeout 0
tcp-keepalive 300

# تنظیمات پایداری
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
aof-use-rdb-preamble yes

# تنظیمات لاگ
loglevel notice
logfile "/data/redis.log"

# تنظیمات پیشرفته
activerehashing yes
aof-rewrite-incremental-fsync yes
rdb-save-incremental-fsync yes

# تنظیمات ذخیره‌سازی
save 900 1
save 300 10
save 60 10000

# تنظیمات مربوط به عملکرد سرور
# حداکثر تعداد کلاینت‌های همزمان
maxclients 10000

# تنظیمات مربوط به حافظه و CPU
# استفاده جهت اختصاص memroy تعیین شده
maxmemory-samples 5

# تنظیمات برای بهبود کارایی
io-threads 4
io-threads-do-reads yes